import '../../domain/entities/surplus_item.dart';

/// Surplus Item Model
/// Data transfer object for SurplusItem entity
class SurplusItemModel extends SurplusItem {
  const SurplusItemModel({
    required super.id,
    required super.title,
    required super.description,
    required super.imageUrl,
    required super.type,
    super.originalPrice,
    super.discountedPrice,
    super.discountPercentage,
    required super.quantity,
    required super.unit,
    required super.expiryDate,
    required super.pickupStartTime,
    required super.pickupEndTime,
    required super.businessId,
    required super.businessName,
    required super.businessType,
    required super.businessLogo,
    required super.pickupAddress,
    super.latitude,
    super.longitude,
    required super.status,
    super.allergens,
    super.dietaryInfo,
    super.views,
    super.claims,
    required super.createdAt,
    super.notes,
  });

  factory SurplusItemModel.fromJson(Map<String, dynamic> json) {
    return SurplusItemModel(
      id: json['id'] as String,
      title: json['title'] as String,
      description: json['description'] as String,
      imageUrl: json['imageUrl'] as String,
      type: SurplusType.values.firstWhere((e) => e.name == json['type']),
      originalPrice: json['originalPrice'] as double?,
      discountedPrice: json['discountedPrice'] as double?,
      discountPercentage: json['discountPercentage'] as int?,
      quantity: json['quantity'] as int,
      unit: json['unit'] as String,
      expiryDate: DateTime.parse(json['expiryDate'] as String),
      pickupStartTime: DateTime.parse(json['pickupStartTime'] as String),
      pickupEndTime: DateTime.parse(json['pickupEndTime'] as String),
      businessId: json['businessId'] as String,
      businessName: json['businessName'] as String,
      businessType: json['businessType'] as String,
      businessLogo: json['businessLogo'] as String,
      pickupAddress: json['pickupAddress'] as String,
      latitude: json['latitude'] as double?,
      longitude: json['longitude'] as double?,
      status: SurplusStatus.values.firstWhere((e) => e.name == json['status']),
      allergens: List<String>.from(json['allergens'] as List? ?? []),
      dietaryInfo: List<String>.from(json['dietaryInfo'] as List? ?? []),
      views: json['views'] as int? ?? 0,
      claims: json['claims'] as int? ?? 0,
      createdAt: DateTime.parse(json['createdAt'] as String),
      notes: json['notes'] as String?,
    );
  }

  Map<String, dynamic> toJson() {
    return {
      'id': id,
      'title': title,
      'description': description,
      'imageUrl': imageUrl,
      'type': type.name,
      'originalPrice': originalPrice,
      'discountedPrice': discountedPrice,
      'discountPercentage': discountPercentage,
      'quantity': quantity,
      'unit': unit,
      'expiryDate': expiryDate.toIso8601String(),
      'pickupStartTime': pickupStartTime.toIso8601String(),
      'pickupEndTime': pickupEndTime.toIso8601String(),
      'businessId': businessId,
      'businessName': businessName,
      'businessType': businessType,
      'businessLogo': businessLogo,
      'pickupAddress': pickupAddress,
      'latitude': latitude,
      'longitude': longitude,
      'status': status.name,
      'allergens': allergens,
      'dietaryInfo': dietaryInfo,
      'views': views,
      'claims': claims,
      'createdAt': createdAt.toIso8601String(),
      'notes': notes,
    };
  }

  factory SurplusItemModel.fromEntity(SurplusItem item) {
    return SurplusItemModel(
      id: item.id,
      title: item.title,
      description: item.description,
      imageUrl: item.imageUrl,
      type: item.type,
      originalPrice: item.originalPrice,
      discountedPrice: item.discountedPrice,
      discountPercentage: item.discountPercentage,
      quantity: item.quantity,
      unit: item.unit,
      expiryDate: item.expiryDate,
      pickupStartTime: item.pickupStartTime,
      pickupEndTime: item.pickupEndTime,
      businessId: item.businessId,
      businessName: item.businessName,
      businessType: item.businessType,
      businessLogo: item.businessLogo,
      pickupAddress: item.pickupAddress,
      latitude: item.latitude,
      longitude: item.longitude,
      status: item.status,
      allergens: item.allergens,
      dietaryInfo: item.dietaryInfo,
      views: item.views,
      claims: item.claims,
      createdAt: item.createdAt,
      notes: item.notes,
    );
  }
}
